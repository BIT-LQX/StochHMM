<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>StochHMM: StochHMM::emm Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Screen Shot 2013-04-23 at 10.38.21 AM.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">StochHMM
   &#160;<span id="projectnumber">v0.30</span>
   </div>
   <div id="projectbrief">Flexible Hidden Markov Model C++ Library and Application</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_stoch_h_m_m.html">StochHMM</a></li><li class="navelem"><a class="el" href="class_stoch_h_m_m_1_1emm.html">emm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">StochHMM::emm Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="emm_8h_source.html">emm.h</a>&gt;</code></p>

<p><a href="class_stoch_h_m_m_1_1emm-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4e5950e2b141aad4eced181fce61d61b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e5950e2b141aad4eced181fce61d61b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a4e5950e2b141aad4eced181fce61d61b">emm</a> ()</td></tr>
<tr class="memdesc:a4e5950e2b141aad4eced181fce61d61b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an emission. <br/></td></tr>
<tr class="memitem:a041ec7323ec5b7cfefe560bdcfaa4c05"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a041ec7323ec5b7cfefe560bdcfaa4c05"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a041ec7323ec5b7cfefe560bdcfaa4c05">emm</a> (std::string &amp;)</td></tr>
<tr class="memdesc:a041ec7323ec5b7cfefe560bdcfaa4c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an empty emission. <br/></td></tr>
<tr class="memitem:aa54b9142ce68426ec436c8b15c11f38a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#aa54b9142ce68426ec436c8b15c11f38a">~emm</a> ()</td></tr>
<tr class="memdesc:aa54b9142ce68426ec436c8b15c11f38a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs emission from a string;.  <a href="#aa54b9142ce68426ec436c8b15c11f38a"></a><br/></td></tr>
<tr class="memitem:a52af53ba74c5cd581643ae4da9eeb080"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a52af53ba74c5cd581643ae4da9eeb080">parse</a> (std::string &amp;, <a class="el" href="class_stoch_h_m_m_1_1tracks.html">tracks</a> &amp;, <a class="el" href="class_stoch_h_m_m_1_1weights.html">weights</a> *, <a class="el" href="class_stoch_h_m_m_1_1_state_funcs.html">StateFuncs</a> *)</td></tr>
<tr class="memitem:a7226ce9e5bf85ea596f897bdcf0dc664"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a7226ce9e5bf85ea596f897bdcf0dc664">parse</a> (std::string &amp;txt, <a class="el" href="class_stoch_h_m_m_1_1track.html">track</a> *trk)</td></tr>
<tr class="memitem:af47fc262c080fa58c97d5508c7fcfbba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af47fc262c080fa58c97d5508c7fcfbba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#af47fc262c080fa58c97d5508c7fcfbba">setRealNumber</a> ()</td></tr>
<tr class="memdesc:af47fc262c080fa58c97d5508c7fcfbba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the emission to a Real Number. <br/></td></tr>
<tr class="memitem:ab95aa772208b03e5b767c09d1a9c0f68"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab95aa772208b03e5b767c09d1a9c0f68"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#ab95aa772208b03e5b767c09d1a9c0f68">setComplement</a> ()</td></tr>
<tr class="memdesc:ab95aa772208b03e5b767c09d1a9c0f68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the emission to be the complement 1-P of given value. <br/></td></tr>
<tr class="memitem:a4c24f3c19de4c4e3fa61ebfdd7066042"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4c24f3c19de4c4e3fa61ebfdd7066042"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setLexicalFunction</b> (<a class="el" href="namespace_stoch_h_m_m.html#a7fad7f980bfaea3d96c891e6db7c8cf0">emissionFunc</a> *)</td></tr>
<tr class="memitem:a45b77f5140432fa2bb9edc9015fb910b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a45b77f5140432fa2bb9edc9015fb910b">isReal</a> ()</td></tr>
<tr class="memitem:a6e6f1be7b72ac0c96c0ee875322b813f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e6f1be7b72ac0c96c0ee875322b813f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a6e6f1be7b72ac0c96c0ee875322b813f">isComplement</a> ()</td></tr>
<tr class="memdesc:a6e6f1be7b72ac0c96c0ee875322b813f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check to see if emission will return the complement (1-P) value of emission. <br/></td></tr>
<tr class="memitem:a1457a3361531d3ada37535af51e3444f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a1457a3361531d3ada37535af51e3444f">get_emission</a> (<a class="el" href="class_stoch_h_m_m_1_1sequences.html">sequences</a> &amp;, size_t)</td></tr>
<tr class="memitem:addea95b05b0ba37ce8fc0cb85ccdcbc4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#addea95b05b0ba37ce8fc0cb85ccdcbc4">get_emission</a> (<a class="el" href="class_stoch_h_m_m_1_1sequence.html">sequence</a> &amp;, size_t)</td></tr>
<tr class="memitem:a7565d01d1c90561cf48ffe175fc98d4e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_stoch_h_m_m_1_1emission_func_param.html">emissionFuncParam</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#a7565d01d1c90561cf48ffe175fc98d4e">getExtFunction</a> ()</td></tr>
<tr class="memitem:ae283fd70c7987041b8cd3f2255594319"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae283fd70c7987041b8cd3f2255594319"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1emm.html#ae283fd70c7987041b8cd3f2255594319">print</a> ()</td></tr>
<tr class="memdesc:ae283fd70c7987041b8cd3f2255594319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the string representation of the emission to stdout. <br/></td></tr>
<tr class="memitem:a6498faaf6fe651e065d37042acf2f709"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6498faaf6fe651e065d37042acf2f709"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>stringify</b> ()</td></tr>
<tr class="memitem:a6ba84f7a73e3b1ff184536dae34a7970"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ba84f7a73e3b1ff184536dae34a7970"></a>
<a class="el" href="class_stoch_h_m_m_1_1lexical_table.html">lexicalTable</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getTables</b> ()</td></tr>
<tr class="memitem:a520d383fcbd364a25e985eedc14dda41"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a520d383fcbd364a25e985eedc14dda41"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isSimple</b> ()</td></tr>
<tr class="memitem:ab2e8eb56a197fa10121cf58850d0fee7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab2e8eb56a197fa10121cf58850d0fee7"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isComplex</b> ()</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a9ded23f3edbd367dcaa3a3c3d49428eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ded23f3edbd367dcaa3a3c3d49428eb"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>state</b></td></tr>
<tr class="memitem:a6e37bb755d74e24f1b3e7e2def3b13e0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e37bb755d74e24f1b3e7e2def3b13e0"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>model</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Emissions for model Contains the emission definition. Each emissions contains the probability, the log(p(x), and counts Counts are used for calculating lower order emissions from higher order. This is only applicable at the beginning of the sequence. Each emission depends on some track or function, an emission can have multiple tracks. Or in other words output a single character from each track it is associated with. Tracks can be either alphabetic, real numbers values. Emissions can also call an external function that is user defined. If ambiguity is defined in the alphabet, the emission score can be defined as such If ambiguity is not defined the returned value will be -INFINITY </p>

<p>Definition at line <a class="el" href="emm_8h_source.html#l00058">58</a> of file <a class="el" href="emm_8h_source.html">emm.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa54b9142ce68426ec436c8b15c11f38a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StochHMM::emm::~emm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs emission from a string;. </p>
<p>Destroy an emission. </p>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00055">55</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">             {</div>
<div class="line">        <span class="keyword">delete</span> lexFunc;</div>
<div class="line">        <span class="keyword">delete</span> tagFunc;</div>
<div class="line">        <span class="keyword">function</span> =      <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">        lexFunc =       NULL;</div>
<div class="line">        tagFunc =       NULL;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1457a3361531d3ada37535af51e3444f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double StochHMM::emm::get_emission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1sequences.html">sequences</a> &amp;&#160;</td>
          <td class="paramname"><em>seqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the emission value given a position in the sequence *If emission is a real number it will return the value from the real number track *If emission is a sequence then it will get the value and return it </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">seqs</td><td>Sequences to use </td></tr>
    <tr><td class="paramname">iter</td><td>Position within the sequences </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>double log(prob) value of emission </dd></dl>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00681">681</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">                                                      {</div>
<div class="line">        <span class="keywordtype">double</span> final_emission(-INFINITY);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (real_number){</div>
<div class="line">            </div>
<div class="line">            final_emission=seqs.realValue(realTrack-&gt;<a class="code" href="class_stoch_h_m_m_1_1track.html#a2c18fbb6e1c6aa8aa41a33d07bc6e279">getIndex</a>(),pos);</div>
<div class="line">            <span class="keywordflow">if</span> (complement){</div>
<div class="line">                final_emission=log(1-exp(final_emission));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">function</span>){</div>
<div class="line">            final_emission=lexFunc-&gt;evaluate(seqs, pos);</div>
<div class="line">        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (multi_continuous){</div>
<div class="line">                        <span class="comment">//Get all values from the tracks</span></div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; number_of_tracks ; ++i){</div>
<div class="line">                                (*pass_values)[i] = seqs.realValue((*track_indices)[i], pos);</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        final_emission = (*multiPdf)(pass_values, dist_parameters);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (complement){</div>
<div class="line">                                final_emission=log(1-exp(final_emission));</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (continuous){</div>
<div class="line">                        </div>
<div class="line">                        final_emission = (*pdf)(seqs.realValue(realTrack-&gt;<a class="code" href="class_stoch_h_m_m_1_1track.html#a2c18fbb6e1c6aa8aa41a33d07bc6e279">getIndex</a>(),pos),dist_parameters);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (complement){</div>
<div class="line">                                final_emission=log(1-exp(final_emission));</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            final_emission=scores.getValue(seqs, pos);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (tagFunc!=NULL){</div>
<div class="line">            final_emission+=tagFunc-&gt;evaluate(seqs, pos);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> final_emission;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addea95b05b0ba37ce8fc0cb85ccdcbc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double StochHMM::emm::get_emission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1sequence.html">sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the emission value given a position in the sequence If emission is a real number it will return the value from the real number track *If emission is a sequence then it will get the value and return it </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">seqs</td><td>Sequences to use </td></tr>
    <tr><td class="paramname">iter</td><td>Position within the sequences </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>double log(prob) value of emission </dd></dl>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00733">733</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">                                                    {</div>
<div class="line">        <span class="keywordtype">double</span> final_emission;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (real_number){</div>
<div class="line">            </div>
<div class="line">            final_emission=seq.realValue(pos);</div>
<div class="line">            <span class="keywordflow">if</span> (complement){</div>
<div class="line">                final_emission=log(1-exp(final_emission));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">function</span>){</div>
<div class="line">            final_emission=lexFunc-&gt;evaluate(seq, pos);</div>
<div class="line">        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (multi_continuous){</div>
<div class="line">                        <span class="comment">//Get all values from the tracks</span></div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; number_of_tracks ; ++i){</div>
<div class="line">                                (*pass_values)[i] = seq.realValue(pos);</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        final_emission = (*multiPdf)(pass_values, dist_parameters);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (complement){</div>
<div class="line">                                final_emission=log(1-exp(final_emission));</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (continuous){</div>
<div class="line">                        </div>
<div class="line">                        final_emission = (*pdf)(seq.realValue(pos),dist_parameters);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (complement){</div>
<div class="line">                                final_emission=log(1-exp(final_emission));</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            final_emission=scores.getValue(seq, pos);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (tagFunc!=NULL){</div>
<div class="line">            final_emission+=tagFunc-&gt;evaluate(seq, pos);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> final_emission;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7565d01d1c90561cf48ffe175fc98d4e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_stoch_h_m_m_1_1emission_func_param.html">emissionFuncParam</a>* StochHMM::emm::getExtFunction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the external Functions defined for the emission </p>
<dl class="section return"><dt>Returns:</dt><dd>externalFuncs* </dd></dl>

<p>Definition at line <a class="el" href="emm_8h_source.html#l00092">92</a> of file <a class="el" href="emm_8h_source.html">emm.h</a>.</p>
<div class="fragment"><div class="line">{<span class="keywordflow">return</span> tagFunc;};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a45b77f5140432fa2bb9edc9015fb910b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StochHMM::emm::isReal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Is the emission from a real Number track </p>
<dl class="section return"><dt>Returns:</dt><dd>true if track is real number track </dd>
<dd>
false if track is alphanumerical track </dd></dl>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00783">783</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">                    {</div>
<div class="line">        <span class="keywordflow">if</span> (real_number &amp;&amp; realTrack-&gt;<a class="code" href="class_stoch_h_m_m_1_1track.html#a4ce8b421ac3f61a6093d81867b4a981f">getAlphaType</a>()==REAL){</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52af53ba74c5cd581643ae4da9eeb080"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StochHMM::emm::parse </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>txt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1tracks.html">tracks</a> &amp;&#160;</td>
          <td class="paramname"><em>trks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1weights.html">weights</a> *&#160;</td>
          <td class="paramname"><em>wts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1_state_funcs.html">StateFuncs</a> *&#160;</td>
          <td class="paramname"><em>funcs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an emission from text model file </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">txt</td><td>String representation of emission </td></tr>
    <tr><td class="paramname">trks</td><td>Tracks used by the model </td></tr>
    <tr><td class="paramname">wts</td><td>Weights used by the model </td></tr>
    <tr><td class="paramname">funcs</td><td>State functions used by the model </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00069">69</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">                                                                               {</div>
<div class="line">        <span class="keywordflow">if</span> (!_processTags(txt,trks, wts, funcs)){</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        stringList ln;</div>
<div class="line">        ln.splitString(txt,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        <span class="keywordtype">size_t</span> idx;</div>
<div class="line">        <span class="keywordflow">if</span> (ln.contains(<span class="stringliteral">&quot;EMISSION&quot;</span>)){</div>
<div class="line">            idx = ln.indexOf(<span class="stringliteral">&quot;EMISSION&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing EMISSION tag from emission. Please check the formatting.   This is what was handed to the emission class:\n &quot;</span> &lt;&lt;  txt &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        stringList line;</div>
<div class="line">        line.splitString(ln[idx], <span class="stringliteral">&quot;\t,: &quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">size_t</span> typeBegin(0);</div>
<div class="line">        </div>
<div class="line">                <span class="comment">//Determine Emission Type and set appropriate flags</span></div>
<div class="line">        <a class="code" href="namespace_stoch_h_m_m.html#ab4c259b67b1db89217aca6fe556d6835">valueType</a>  valtyp(PROBABILITY);</div>
<div class="line">        <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;P(X)&quot;</span>)){</div>
<div class="line">            typeBegin = line.indexOf(<span class="stringliteral">&quot;P(X)&quot;</span>);</div>
<div class="line">            valtyp=PROBABILITY;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;LOG&quot;</span>)){</div>
<div class="line">            typeBegin = line.indexOf(<span class="stringliteral">&quot;LOG&quot;</span>);</div>
<div class="line">            valtyp=LOG_PROB;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;COUNTS&quot;</span>)){</div>
<div class="line">            typeBegin = line.indexOf(<span class="stringliteral">&quot;COUNTS&quot;</span>);</div>
<div class="line">            valtyp=COUNTS ;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;REAL_NUMBER&quot;</span>)){</div>
<div class="line">            typeBegin = line.indexOf(<span class="stringliteral">&quot;REAL_NUMBER&quot;</span>);</div>
<div class="line">            real_number = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;COMPLEMENT&quot;</span>) || line.contains(<span class="stringliteral">&quot;1-P(X)&quot;</span>)) {</div>
<div class="line">                complement=<span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;MULTI_CONTINUOUS&quot;</span>)){</div>
<div class="line">                        typeBegin = line.indexOf(<span class="stringliteral">&quot;MULTI_CONTINUOUS&quot;</span>);</div>
<div class="line">                        multi_continuous=<span class="keyword">true</span>;</div>
<div class="line">                        <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;COMPLEMENT&quot;</span>) || line.contains(<span class="stringliteral">&quot;1-P(X)&quot;</span>)) {</div>
<div class="line">                complement=<span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;CONTINUOUS&quot;</span>)){</div>
<div class="line">                        typeBegin = line.indexOf(<span class="stringliteral">&quot;CONTINUOUS&quot;</span>);</div>
<div class="line">                        continuous=<span class="keyword">true</span>;</div>
<div class="line">                        <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;COMPLEMENT&quot;</span>) || line.contains(<span class="stringliteral">&quot;1-P(X)&quot;</span>)) {</div>
<div class="line">                complement=<span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;FUNCTION&quot;</span>)){</div>
<div class="line">            typeBegin = line.indexOf(<span class="stringliteral">&quot;FUNCTION&quot;</span>);</div>
<div class="line">            <span class="keyword">function</span>=<span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            std::string info = <span class="stringliteral">&quot;Couldn&#39;t parse Value type in the Emission: &quot;</span> + txt  + <span class="stringliteral">&quot; Please check the formatting.   The allowed types are: P(X), LOG, COUNTS, or REAL_NUMBER. \n&quot;</span>;</div>
<div class="line">            std::cerr &lt;&lt; info &lt;&lt; std::endl;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">//errorInfo(sCantParseLine, info.c_str());</span></div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        </div>
<div class="line">        <span class="comment">//remaining tracks and Orders then set Track</span></div>
<div class="line">        std::vector&lt;track*&gt; tempTracks;</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=1;i&lt;typeBegin;i++){</div>
<div class="line">            track* tk = trks.getTrack(line[i]);</div>
<div class="line">            <span class="keywordflow">if</span> (tk==NULL){</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Emissions tried to add a track named: &quot;</span> &lt;&lt; line[i] &lt;&lt; <span class="stringliteral">&quot; . However, there isn&#39;t a matching track in the model.  Please check to model formatting.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                tempTracks.push_back(tk);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Real Number Emissions</span></div>
<div class="line">        <span class="keywordflow">if</span> (real_number){</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (tempTracks.size()&gt;1){</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Multiple tracks listed under Real Track Emission Definition\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            realTrack = tempTracks[0];</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">                <span class="comment">//Multivariate Continuous PDF emission</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (multi_continuous){</div>
<div class="line">                        <span class="keywordflow">if</span> (tempTracks.size()==1){</div>
<div class="line">                                std::cerr &lt;&lt; <span class="stringliteral">&quot;Only a single track listed under MULTI_CONTINUOUS\n\</span></div>
<div class="line"><span class="stringliteral">                                Use CONTINUOUS instead of MULTI-CONTINUOUS\n&quot;</span>;</div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Assign track information</span></div>
<div class="line">                        track_indices = <span class="keyword">new</span> std::vector&lt;size_t&gt;;</div>
<div class="line">                        trcks = <span class="keyword">new</span> std::vector&lt;track*&gt; (tempTracks);</div>
<div class="line">                        number_of_tracks = trcks-&gt;size();</div>
<div class="line">                        pass_values = <span class="keyword">new</span> std::vector&lt;double&gt; (number_of_tracks,-INFINITY);</div>
<div class="line">                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; number_of_tracks ; ++i){</div>
<div class="line">                                track_indices-&gt;push_back((*trcks)[i]-&gt;getIndex());</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        idx = ln.indexOf(<span class="stringliteral">&quot;PDF&quot;</span>);</div>
<div class="line">                        line.splitString(ln[idx],<span class="stringliteral">&quot;\t:, &quot;</span>);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordtype">size_t</span> function_idx = line.indexOf(<span class="stringliteral">&quot;PDF&quot;</span>) + 1;</div>
<div class="line">                        multiPdfName = line[function_idx];</div>
<div class="line">            multiPdf = funcs-&gt;getMultivariatePdfFunction(multiPdfName);</div>
<div class="line">                        </div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordtype">size_t</span> parameter_idx = line.indexOf(<span class="stringliteral">&quot;PARAMETERS&quot;</span>);</div>
<div class="line">                        </div>
<div class="line">                        dist_parameters = <span class="keyword">new</span>(std::nothrow) std::vector&lt;double&gt;;</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span>(parameter_idx != SIZE_MAX){</div>
<div class="line">                                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = parameter_idx+1 ; i&lt; line.size() ; i++){</div>
<div class="line">                                        <span class="keywordtype">double</span> value;</div>
<div class="line">                                        <a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[i], value);</div>
<div class="line">                                        dist_parameters-&gt;push_back(value);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                        </div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//U</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (continuous){</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (tempTracks.size()&gt;1){</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Multiple tracks listed under CONTINUOUS Track Emission Definition\n\</span></div>
<div class="line"><span class="stringliteral">                                Must use MULTI_CONTINUOUS for multivariate emissions\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            realTrack = tempTracks[0];</div>
<div class="line">                        </div>
<div class="line">                        idx = ln.indexOf(<span class="stringliteral">&quot;PDF&quot;</span>);</div>
<div class="line">                        line.splitString(ln[idx],<span class="stringliteral">&quot;\t:, &quot;</span>);</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordtype">size_t</span> function_idx = line.indexOf(<span class="stringliteral">&quot;PDF&quot;</span>) + 1;</div>
<div class="line">                        pdfName = line[function_idx];</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordtype">size_t</span> parameter_idx = line.indexOf(<span class="stringliteral">&quot;PARAMETERS&quot;</span>);</div>
<div class="line">                        dist_parameters = <span class="keyword">new</span>(std::nothrow) std::vector&lt;double&gt;;</div>
<div class="line">                        </div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span>(parameter_idx != SIZE_MAX){</div>
<div class="line">                                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = parameter_idx+1 ; i&lt; line.size() ; i++){</div>
<div class="line">                                        <span class="keywordtype">double</span> value;</div>
<div class="line">                                        <a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[i], value);</div>
<div class="line">                                        dist_parameters-&gt;push_back(value);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">            pdf = funcs-&gt;getPDFFunction(pdfName);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">function</span>){</div>
<div class="line">                        <span class="comment">//Get function name</span></div>
<div class="line">            std::string&amp; functionName = line[typeBegin+1];</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Set parameters for function</span></div>
<div class="line">            lexFunc = <span class="keyword">new</span>(std::nothrow) emissionFuncParam(functionName,funcs,tempTracks[0]);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (lexFunc==NULL){</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;OUT OF MEMORY\nFile&quot;</span> &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;Line:\t&quot;</span>&lt;&lt; __LINE__ &lt;&lt; std::endl;</div>
<div class="line">                exit(1);</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{  <span class="comment">//Traditional Lexcical Emission</span></div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (ln.contains(<span class="stringliteral">&quot;ORDER&quot;</span>)){</div>
<div class="line">                idx=ln.indexOf(<span class="stringliteral">&quot;ORDER&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t find ORDER in non-Real_Number emission.  Please check the formatting&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                <span class="comment">//errorInfo(sCantParseLine, &quot;Couldn&#39;t find ORDER in non-Real_Number emission.  Please check the formatting\n&quot;);</span></div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            std::vector&lt;int&gt; tempOrder;</div>
<div class="line">            line.splitString(ln[idx],<span class="stringliteral">&quot;\t:, &quot;</span>);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordtype">size_t</span> orderIdx = line.indexOf(<span class="stringliteral">&quot;ORDER&quot;</span>);</div>
<div class="line">            orderIdx++;</div>
<div class="line">            </div>
<div class="line">            <span class="keywordtype">size_t</span> ambIdx; </div>
<div class="line">            <span class="keywordtype">bool</span> containsAmbig = line.contains(<span class="stringliteral">&quot;AMBIGUOUS&quot;</span>);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (containsAmbig){ambIdx=line.indexOf(<span class="stringliteral">&quot;AMBIGUOUS&quot;</span>);}</div>
<div class="line">            <span class="keywordflow">else</span>{ ambIdx= line.size();}</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=orderIdx;i&lt;ambIdx;i++){</div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">int</span> tempValue;</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga4797b0d53af278c2adb72a47f20cfe7d">stringToInt</a>(line[i], tempValue)){</div>
<div class="line">                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Emission Order not numeric&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (tempValue&gt;32){</div>
<div class="line">                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Emission order is greater than 32.  Must be 32 or less&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                tempOrder.push_back(tempValue);</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (tempOrder.size() == tempTracks.size()){</div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;tempOrder.size();i++){</div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a68d21a550a91ae82ae73b272208513f2">addTrack</a>(tempTracks[i], tempOrder[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;Different number of tracks and orders parsed in Emission: &quot;</span> &lt;&lt; txt &lt;&lt; <span class="stringliteral">&quot; Check the formatting of the Emission&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            <span class="comment">//Parse Ambiguous Tag Info</span></div>
<div class="line">            <span class="keywordflow">if</span> (containsAmbig){</div>
<div class="line">                ambIdx++;</div>
<div class="line">                <span class="keywordflow">if</span> (line.size()&lt;=ambIdx){</div>
<div class="line">                    std::cerr &lt;&lt; <span class="stringliteral">&quot;No scoring type after AMBIGUOUS label\nAssuming AVG\n&quot;</span>;</div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(AVERAGE_SCORE);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;AVG&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(AVERAGE_SCORE);}</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;MAX&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(HIGHEST_SCORE);}</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;MIN&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(LOWEST_SCORE);}</div>
<div class="line">                                </div>
<div class="line">                                <span class="comment">//Constant values assigned for Ambiguous characters</span></div>
<div class="line">                                <span class="comment">//Can either be passed as P(X) or LOG</span></div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;P(X)&quot;</span>)==0)</div>
<div class="line">                {</div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(DEFINED_SCORE);</div>
<div class="line">                    </div>
<div class="line">                    ambIdx++;</div>
<div class="line">                    <span class="keywordflow">if</span> (ambIdx&gt;=line.size()){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing Ambiguous Value&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                                    </div>
<div class="line">                    <span class="keywordtype">double</span> tempValue;</div>
<div class="line">                    <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[ambIdx], tempValue)){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Ambiguous Value couldn&#39;t be parsed: &quot;</span>&lt;&lt; line[ambIdx] &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                    </div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a6205d81408d19fb30da0729b0d68c860" title="Set a given score to be returned for unknownCharScoringType.">setUnkScore</a>(log(tempValue));</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;LOG&quot;</span>)==0){</div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(DEFINED_SCORE);</div>
<div class="line">                    ambIdx++;</div>
<div class="line">                    </div>
<div class="line">                    <span class="keywordflow">if</span> (ambIdx&gt;=line.size()){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing Ambiguous Value&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                    </div>
<div class="line">                    <span class="keywordtype">double</span> tempValue;</div>
<div class="line">                    <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[ambIdx], tempValue)){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Ambiguous Value couldn&#39;t be parsed: &quot;</span>&lt;&lt; line[ambIdx] &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                    </div>
<div class="line">                    scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a6205d81408d19fb30da0729b0d68c860" title="Set a given score to be returned for unknownCharScoringType.">setUnkScore</a>(tempValue);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        </div>
<div class="line">            <span class="comment">//Get Emission Tables</span></div>
<div class="line">            <span class="keywordtype">size_t</span> expectedColumns(1);</div>
<div class="line">            <span class="keywordtype">size_t</span> expectedRows(1);</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i&lt;scores.getNumberOfAlphabets(); i++){</div>
<div class="line">                expectedColumns*=scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#aeb1a35912d089e165de43c3c35b9e3e4">getAlphaSize</a>(i);</div>
<div class="line">                expectedRows*=POWER[scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a1516c1242e82b229a2449c6710735606">getOrder</a>(i)][scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#aeb1a35912d089e165de43c3c35b9e3e4">getAlphaSize</a>(i)-1];</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            std::vector&lt;std::vector&lt;double&gt; &gt;* log_prob = scores.getLogProbabilityTable();</div>
<div class="line">            std::vector&lt;std::vector&lt;double&gt; &gt;* prob = scores.getProbabilityTable();</div>
<div class="line">            std::vector&lt;std::vector&lt;double&gt; &gt;* counts = scores.getCountsTable();</div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iter = 2; iter&lt; ln.size();iter++){</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                <span class="comment">//If it&#39;s the first line check for a &#39;#&#39; indicating that the column header is present</span></div>
<div class="line">                <span class="keywordflow">if</span> (iter==2 &amp;&amp; ln[iter][0]==<span class="charliteral">&#39;@&#39;</span>){</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                line.splitString(ln[iter],<span class="stringliteral">&quot;\t &quot;</span>);</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Check for Row header</span></div>
<div class="line">                <span class="keywordflow">if</span> (line[0][0]==<span class="charliteral">&#39;@&#39;</span>){</div>
<div class="line">                    line.pop_ith(0);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                std::vector&lt;double&gt; temp = line.toVecDouble();</div>
<div class="line">                <span class="keywordflow">if</span> (temp.size() != expectedColumns){</div>
<div class="line">                    std::string info = <span class="stringliteral">&quot;The following line couldn&#39;t be parsed into the required number of columns.   Expected Columns: &quot;</span> + <a class="code" href="group___text.html#ga85eb97cbbeb8e493349a04ffaabb1bbf">int_to_string</a>(expectedColumns) + <span class="stringliteral">&quot;\n The line appears as: &quot;</span>  + ln[iter] ;</div>
<div class="line">                    </div>
<div class="line">                    std::cerr &lt;&lt; info &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                    <span class="comment">//errorInfo(sCantParseLine, info.c_str());</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>{</div>
<div class="line">                    <span class="keywordflow">if</span> (valtyp == PROBABILITY){</div>
<div class="line">                        prob-&gt;push_back(temp);</div>
<div class="line">                        logVector(temp);</div>
<div class="line">                        log_prob-&gt;push_back(temp);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valtyp == LOG_PROB){</div>
<div class="line">                        log_prob-&gt;push_back(temp);</div>
<div class="line">                        expVector(temp);</div>
<div class="line">                        prob-&gt;push_back(temp);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valtyp == COUNTS){</div>
<div class="line">                        counts-&gt;push_back(temp);</div>
<div class="line">                        probVector(temp);</div>
<div class="line">                        prob-&gt;push_back(temp);</div>
<div class="line">                        logVector(temp);</div>
<div class="line">                        log_prob-&gt;push_back(temp);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (log_prob-&gt;size() != expectedRows){</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot; The Emission table doesn&#39;t contain enough rows.  Expected Rows: &quot;</span> &lt;&lt; expectedRows &lt;&lt; <span class="stringliteral">&quot; \n Please check the Emission Table and formatting for &quot;</span> &lt;&lt;  txt &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">                        </div>
<div class="line">                        scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#abbb120b9335dea4067170fe62a9538ab" title="Initialize the final emission table with ambiguous characters.">initialize_emission_table</a>();</div>
<div class="line">                        </div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7226ce9e5bf85ea596f897bdcf0dc664"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StochHMM::emm::parse </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>txt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1track.html">track</a> *&#160;</td>
          <td class="paramname"><em>trk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an emission from text </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">txt</td><td>String representation of emission </td></tr>
    <tr><td class="paramname">trks</td><td>Tracks used by the model </td></tr>
    <tr><td class="paramname">wts</td><td>Weights used by the model </td></tr>
    <tr><td class="paramname">funcs</td><td>State functions used by the model </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="emm_8cpp_source.html#l00427">427</a> of file <a class="el" href="emm_8cpp_source.html">emm.cpp</a>.</p>
<div class="fragment"><div class="line">                                            {</div>
<div class="line">        </div>
<div class="line">        stringList ln;</div>
<div class="line">        ln.splitString(txt,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">        <span class="keywordtype">size_t</span> idx;</div>
<div class="line">        <span class="keywordflow">if</span> (ln.contains(<span class="stringliteral">&quot;EMISSION&quot;</span>)){</div>
<div class="line">            idx = ln.indexOf(<span class="stringliteral">&quot;EMISSION&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing EMISSION tag from emission. Please check the formatting.   This is what was handed to the emission class:\n &quot;</span> &lt;&lt;  txt &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        stringList line;</div>
<div class="line">        line.splitString(ln[idx], <span class="stringliteral">&quot;\t,: &quot;</span>);</div>
<div class="line">                <span class="comment">//size_t typeBegin(0);</span></div>
<div class="line">                </div>
<div class="line">        <a class="code" href="namespace_stoch_h_m_m.html#ab4c259b67b1db89217aca6fe556d6835">valueType</a>  valtyp(PROBABILITY);</div>
<div class="line">        <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;P(X)&quot;</span>)){</div>
<div class="line">            <span class="comment">//typeBegin = line.indexOf(&quot;P(X)&quot;);</span></div>
<div class="line">            valtyp=PROBABILITY;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;LOG&quot;</span>)){</div>
<div class="line">            <span class="comment">//typeBegin = line.indexOf(&quot;LOG&quot;);</span></div>
<div class="line">            valtyp=LOG_PROB;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line.contains(<span class="stringliteral">&quot;COUNTS&quot;</span>)){</div>
<div class="line">            <span class="comment">//typeBegin = line.indexOf(&quot;COUNTS&quot;);</span></div>
<div class="line">            valtyp=COUNTS ;</div>
<div class="line">        }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">            std::string info = <span class="stringliteral">&quot;Couldn&#39;t parse Value type in the Emission: &quot;</span> + txt  + <span class="stringliteral">&quot; Please check the formatting.   The allowed types are: P(X), LOG, COUNTS, or REAL_NUMBER. \n&quot;</span>;</div>
<div class="line">            std::cerr &lt;&lt; info &lt;&lt; std::endl;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">//errorInfo(sCantParseLine, info.c_str());</span></div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        </div>
<div class="line">        <span class="comment">//remaining tracks and Orders then set Track</span></div>
<div class="line">        std::vector&lt;track*&gt; temp_tracks;</div>
<div class="line">                temp_tracks.push_back(trk);</div>
<div class="line">        </div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (ln.contains(<span class="stringliteral">&quot;ORDER&quot;</span>)){</div>
<div class="line">                        idx=ln.indexOf(<span class="stringliteral">&quot;ORDER&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>{</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t find ORDER in non-Real_Number emission.  Please check the formatting&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                        <span class="comment">//errorInfo(sCantParseLine, &quot;Couldn&#39;t find ORDER in non-Real_Number emission.  Please check the formatting\n&quot;);</span></div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                std::vector&lt;int&gt; temp_order;</div>
<div class="line">                line.splitString(ln[idx],<span class="stringliteral">&quot;\t:,&quot;</span>);</div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">size_t</span> orderIdx = line.indexOf(<span class="stringliteral">&quot;ORDER&quot;</span>);</div>
<div class="line">                orderIdx++;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">size_t</span> ambIdx;</div>
<div class="line">                <span class="keywordtype">bool</span> containsAmbig = line.contains(<span class="stringliteral">&quot;AMBIGUOUS&quot;</span>);</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (containsAmbig){ambIdx=line.indexOf(<span class="stringliteral">&quot;AMBIGUOUS&quot;</span>);}</div>
<div class="line">                <span class="keywordflow">else</span>{ ambIdx= line.size();}</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=orderIdx;i&lt;ambIdx;i++){</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordtype">int</span> temp_value;</div>
<div class="line">                        <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga4797b0d53af278c2adb72a47f20cfe7d">stringToInt</a>(line[i], temp_value)){</div>
<div class="line">                                std::cerr &lt;&lt; <span class="stringliteral">&quot;Emission Order not numeric&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">if</span> (temp_value&gt;32){</div>
<div class="line">                                std::cerr &lt;&lt; <span class="stringliteral">&quot;Emission order is greater than 32.  Must be 32 or less&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        temp_order.push_back(temp_value);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (temp_order.size() == temp_tracks.size()){</div>
<div class="line">                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;temp_order.size();i++){</div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a68d21a550a91ae82ae73b272208513f2">addTrack</a>(temp_tracks[i], temp_order[i]);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>{</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Different number of tracks and orders parsed in Emission: &quot;</span> &lt;&lt; txt &lt;&lt; <span class="stringliteral">&quot; Check the formatting of the Emission&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Parse Ambiguous Tag Info</span></div>
<div class="line">                <span class="keywordflow">if</span> (containsAmbig){</div>
<div class="line">                        ambIdx++;</div>
<div class="line">                        <span class="keywordflow">if</span> (line.size()&lt;=ambIdx){</div>
<div class="line">                                std::cerr &lt;&lt; <span class="stringliteral">&quot;No scoring type after AMBIGUOUS label\nAssuming AVG\n&quot;</span>;</div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(AVERAGE_SCORE);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;AVG&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(AVERAGE_SCORE);}</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;MAX&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(HIGHEST_SCORE);}</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;MIN&quot;</span>)==0){scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(LOWEST_SCORE);}</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;P(X)&quot;</span>)==0)</div>
<div class="line">                        {</div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(DEFINED_SCORE);</div>
<div class="line">                                </div>
<div class="line">                                ambIdx++;</div>
<div class="line">                                <span class="keywordflow">if</span> (ambIdx&gt;=line.size()){</div>
<div class="line">                                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing Ambiguous Value&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        </div>
<div class="line">                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                                }</div>
<div class="line">                                </div>
<div class="line">                                <span class="keywordtype">double</span> tempValue;</div>
<div class="line">                                <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[ambIdx], tempValue)){</div>
<div class="line">                                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Ambiguous Value couldn&#39;t be parsed: &quot;</span>&lt;&lt; line[ambIdx] &lt;&lt; std::endl;</div>
<div class="line">                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                                }</div>
<div class="line">                                </div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a6205d81408d19fb30da0729b0d68c860" title="Set a given score to be returned for unknownCharScoringType.">setUnkScore</a>(log(tempValue));</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (line[ambIdx].compare(<span class="stringliteral">&quot;LOG&quot;</span>)==0){</div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a59b720c8669399e13c7dfb4c0118930f">setUnkScoreType</a>(DEFINED_SCORE);</div>
<div class="line">                                ambIdx++;</div>
<div class="line">                                </div>
<div class="line">                                <span class="keywordflow">if</span> (ambIdx&gt;=line.size()){</div>
<div class="line">                                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing Ambiguous Value&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        </div>
<div class="line">                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                                }</div>
<div class="line">                                </div>
<div class="line">                                <span class="keywordtype">double</span> tempValue;</div>
<div class="line">                                <span class="keywordflow">if</span> (!<a class="code" href="group___text.html#ga68bd6b3175dd081e05a72e7cff42a7d8">stringToDouble</a>(line[ambIdx], tempValue)){</div>
<div class="line">                                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Ambiguous Value couldn&#39;t be parsed: &quot;</span>&lt;&lt; line[ambIdx] &lt;&lt; std::endl;</div>
<div class="line">                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                                }</div>
<div class="line">                                </div>
<div class="line">                                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a6205d81408d19fb30da0729b0d68c860" title="Set a given score to be returned for unknownCharScoringType.">setUnkScore</a>(tempValue);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Get Tables</span></div>
<div class="line">                <span class="keywordtype">size_t</span> expectedColumns(1);</div>
<div class="line">                <span class="keywordtype">size_t</span> expectedRows(1);</div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i&lt;scores.getNumberOfAlphabets(); i++){</div>
<div class="line">                        expectedColumns*=scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#aeb1a35912d089e165de43c3c35b9e3e4">getAlphaSize</a>(i);</div>
<div class="line">                        expectedRows*=POWER[scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#a1516c1242e82b229a2449c6710735606">getOrder</a>(i)][scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#aeb1a35912d089e165de43c3c35b9e3e4">getAlphaSize</a>(i)-1];</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                std::vector&lt;std::vector&lt;double&gt; &gt;* log_prob = scores.getLogProbabilityTable();</div>
<div class="line">                std::vector&lt;std::vector&lt;double&gt; &gt;* prob = scores.getProbabilityTable();</div>
<div class="line">                std::vector&lt;std::vector&lt;double&gt; &gt;* counts = scores.getCountsTable();</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iter = 2; iter&lt; ln.size();iter++){</div>
<div class="line">                        </div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//If it&#39;s the first line check for a &#39;#&#39; indicating that the column header is present</span></div>
<div class="line">                        <span class="keywordflow">if</span> (iter==2 &amp;&amp; ln[iter][0]==<span class="charliteral">&#39;@&#39;</span>){</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        line.splitString(ln[iter],<span class="stringliteral">&quot;\t &quot;</span>);</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Check for Row header</span></div>
<div class="line">                        <span class="keywordflow">if</span> (line[0][0]==<span class="charliteral">&#39;@&#39;</span>){</div>
<div class="line">                                line.pop_ith(0);</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        </div>
<div class="line">                        std::vector&lt;double&gt; temp = line.toVecDouble();</div>
<div class="line">                        <span class="keywordflow">if</span> (temp.size() != expectedColumns){</div>
<div class="line">                                std::string info = <span class="stringliteral">&quot;The following line couldn&#39;t be parsed into the required number of columns.   Expected Columns: &quot;</span> + <a class="code" href="group___text.html#ga85eb97cbbeb8e493349a04ffaabb1bbf">int_to_string</a>(expectedColumns) + <span class="stringliteral">&quot;\n The line appears as: &quot;</span>  + ln[iter] ;</div>
<div class="line">                                </div>
<div class="line">                                std::cerr &lt;&lt; info &lt;&lt; std::endl;</div>
<div class="line">                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                                <span class="comment">//errorInfo(sCantParseLine, info.c_str());</span></div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span>{</div>
<div class="line">                                <span class="keywordflow">if</span> (valtyp == PROBABILITY){</div>
<div class="line">                                        prob-&gt;push_back(temp);</div>
<div class="line">                                        logVector(temp);</div>
<div class="line">                                        log_prob-&gt;push_back(temp);</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valtyp == LOG_PROB){</div>
<div class="line">                                        log_prob-&gt;push_back(temp);</div>
<div class="line">                                        expVector(temp);</div>
<div class="line">                                        prob-&gt;push_back(temp);</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valtyp == COUNTS){</div>
<div class="line">                                        counts-&gt;push_back(temp);</div>
<div class="line">                                        probVector(temp);</div>
<div class="line">                                        prob-&gt;push_back(temp);</div>
<div class="line">                                        logVector(temp);</div>
<div class="line">                                        log_prob-&gt;push_back(temp);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (log_prob-&gt;size() != expectedRows){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot; The Emission table doesn&#39;t contain enough rows.  Expected Rows: &quot;</span> &lt;&lt; expectedRows &lt;&lt; <span class="stringliteral">&quot; \n Please check the Emission Table and formatting for &quot;</span> &lt;&lt;  txt &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                scores.<a class="code" href="class_stoch_h_m_m_1_1lexical_table.html#abbb120b9335dea4067170fe62a9538ab" title="Initialize the final emission table with ambiguous characters.">initialize_emission_table</a>();</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> (tagFunc != NULL){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Not NULL&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="emm_8h_source.html">emm.h</a></li>
<li><a class="el" href="emm_8cpp_source.html">emm.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 23 2013 10:54:58 for StochHMM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
