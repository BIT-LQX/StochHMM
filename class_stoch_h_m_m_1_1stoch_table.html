<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>StochHMM: StochHMM::stochTable Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">StochHMM
   &#160;<span id="projectnumber">v0.34</span>
   </div>
   <div id="projectbrief">Flexible Hidden Markov Model C++ Library and Application</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_stoch_h_m_m.html">StochHMM</a></li><li class="navelem"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">StochHMM::stochTable Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="stoch_table_8h_source.html">stochTable.h</a>&gt;</code></p>

<p><a href="class_stoch_h_m_m_1_1stoch_table-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_stoch_h_m_m_1_1stoch_table_1_1stoch__value.html">stoch_value</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a080d7792392b395b6ae37cec3701a6d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#a080d7792392b395b6ae37cec3701a6d8">stochTable</a> (size_t)</td></tr>
<tr class="memitem:ae770ea1a1422b6d7706e05ee21cf1558"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#ae770ea1a1422b6d7706e05ee21cf1558">~stochTable</a> ()</td></tr>
<tr class="memitem:a00d3a5df377d0b618d2e9d705eeaa3ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#a00d3a5df377d0b618d2e9d705eeaa3ec">push</a> (size_t pos, size_t st, size_t st_to, float val)</td></tr>
<tr class="memitem:ada9bfba8e6f8364190c35bcaa1b0e020"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#ada9bfba8e6f8364190c35bcaa1b0e020">stringify</a> ()</td></tr>
<tr class="memdesc:ada9bfba8e6f8364190c35bcaa1b0e020"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stringify the <a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a>.  <a href="#ada9bfba8e6f8364190c35bcaa1b0e020"></a><br/></td></tr>
<tr class="memitem:afe93c3bc97d4bc96256d0905c73d16ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#afe93c3bc97d4bc96256d0905c73d16ff">print</a> ()</td></tr>
<tr class="memdesc:afe93c3bc97d4bc96256d0905c73d16ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the <a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a> to stdout.  <a href="#afe93c3bc97d4bc96256d0905c73d16ff"></a><br/></td></tr>
<tr class="memitem:acda57c084c4fd7fe15b498ab8eb516ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#acda57c084c4fd7fe15b498ab8eb516ce">finalize</a> ()</td></tr>
<tr class="memitem:acb25865587205a78cff5791c14d461eb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#acb25865587205a78cff5791c14d461eb">get_state_position</a> (size_t pos, uint16_t)</td></tr>
<tr class="memitem:a54b03475f783c305b38b8edbc11069e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#a54b03475f783c305b38b8edbc11069e7">traceback</a> (<a class="el" href="class_stoch_h_m_m_1_1traceback__path.html">traceback_path</a> &amp;path)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abd42b5a72712ab79211fe13f2c6450b0"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a></td></tr>
<tr class="memitem:a91107816897541272e01c391af18496b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="struct_stoch_h_m_m_1_1stoch_table_1_1stoch__value.html">stoch_value</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a></td></tr>
<tr class="memitem:a833bb508d1aebe85e1b73fc68699bb90"><td class="memItemLeft" align="right" valign="top">std::vector&lt; size_t &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Stochastic table stores stochastic values in a vector. Data structure is implemented to reduce the memory that would be needed if we allocated a 2D table with all the transitions. This lookup table is 1D and only stores those values which we add. Each the value are stores (Current state, Previous State, Score as P(X)). In addition, the indices of each state and position are recorded so that they can be referenced quickly. So the memory size necessary to store the values for a sparsely connected model are greatly reduce. However, the time to recreate the table is increased because it doesn't allocate the memory up front, but rather pushes values as they are recorded. </p>

<p>Definition at line <a class="el" href="stoch_table_8h_source.html#l00034">34</a> of file <a class="el" href="stoch_table_8h_source.html">stochTable.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a080d7792392b395b6ae37cec3701a6d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StochHMM::stochTable::stochTable </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seq_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a> constructor </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq_size</td><td>Size of sequence </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00015">15</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00063">last_position</a>, <a class="el" href="stoch_table_8h_source.html#l00065">position</a>, and <a class="el" href="stoch_table_8h_source.html#l00064">state_val</a>.</p>
<div class="fragment"><div class="line">                                             :<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>(NULL){</div>
<div class="line">                </div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a> = <span class="keyword">new</span>(std::nothrow) std::vector&lt;stoch_value&gt;;</div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;reserve(seq_size);</div>
<div class="line">                </div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a> = <span class="keyword">new</span>(std::nothrow) std::vector&lt;size_t&gt;(seq_size,0);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a> == NULL){</div>
<div class="line">                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Cannot allocate stochTable- OUT OF MEMORY&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                        <span class="keyword">delete</span> <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>;</div>
<div class="line">                        <span class="keyword">delete</span> <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>;</div>
<div class="line">                        <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a> = NULL;</div>
<div class="line">                        <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a> = NULL;</div>
<div class="line">                        exit(2);</div>
<div class="line">                }</div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a> = 0;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae770ea1a1422b6d7706e05ee21cf1558"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StochHMM::stochTable::~stochTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00033">33</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00065">position</a>, and <a class="el" href="stoch_table_8h_source.html#l00064">state_val</a>.</p>
<div class="fragment"><div class="line">                               {</div>
<div class="line">                <span class="keyword">delete</span> <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>;</div>
<div class="line">                <span class="keyword">delete</span> <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>;</div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a> = NULL;</div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a> = NULL;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="acda57c084c4fd7fe15b498ab8eb516ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochHMM::stochTable::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finalized <a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a> Normalizes the traceback pointer values and calculates the previous cell iterator within the previous position segment. This speeds up the the referencing necessary for tracebacks across the traceback table. </p>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00059">59</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_math_8h_source.html#l00179">StochHMM::addLog()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00141">get_state_position()</a>, <a class="el" href="stoch_table_8h_source.html#l00063">last_position</a>, <a class="el" href="stoch_table_8h_source.html#l00065">position</a>, <a class="el" href="bitwise__ops_8h_source.html#l00024">SIZE_MAX</a>, and <a class="el" href="stoch_table_8h_source.html#l00064">state_val</a>.</p>

<p>Referenced by <a class="el" href="stoch__forward_8cpp_source.html#l00174">StochHMM::trellis::naive_stochastic_forward()</a>, <a class="el" href="stoch__viterbi_8cpp_source.html#l00181">StochHMM::trellis::naive_stochastic_viterbi()</a>, <a class="el" href="stoch__forward_8cpp_source.html#l00030">StochHMM::trellis::simple_stochastic_forward()</a>, and <a class="el" href="stoch__viterbi_8cpp_source.html#l00042">StochHMM::trellis::simple_stochastic_viterbi()</a>.</p>
<div class="fragment"><div class="line">                                 {</div>
<div class="line">                (*position)[<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a>] = <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;size()-1;</div>
<div class="line">                </div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a> = 0;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">double</span> sum(-INFINITY);</div>
<div class="line">                uint16_t current_state(<a class="code" href="bitwise__ops_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>);</div>
<div class="line">                <span class="keywordtype">size_t</span> state_start(-1);</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//For each position in the sequence we want to normalize the viterbi/forward values</span></div>
<div class="line">                <span class="comment">//for the state from previous states</span></div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;size()-1;++i){</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Need to sum the values.  If we see another state then we&#39;ll need to</span></div>
<div class="line">                        <span class="comment">//normalize the previous states that contributed to the sum.</span></div>
<div class="line">                        <span class="comment">//Then set the sum for the current state.</span></div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = (i==0) ? 0 : (*position)[i-1]+1; j &lt;= (*position)[i] ; ++j ){</div>
<div class="line">                                </div>
<div class="line">                                <span class="comment">//If this is a different state then we&#39;ll need to apply the sum</span></div>
<div class="line">                                <span class="comment">//if this is the first state then we&#39;ll just set the current state</span></div>
<div class="line">                                <span class="comment">//and set the sum value.  Also need to keep track of which state</span></div>
<div class="line">                                <span class="comment">// is the first state so when we normalize we only normalize the</span></div>
<div class="line">                                <span class="comment">// the previous state</span></div>
<div class="line">                                <span class="keywordflow">if</span> ((*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[j].state_id != current_state){</div>
<div class="line">                                        </div>
<div class="line">                                        <span class="comment">//Normalize</span></div>
<div class="line">                                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k = state_start; k &lt; j ;++k){</div>
<div class="line">                                                (*state_val)[k].prob = exp((*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[k].prob - sum);</div>
<div class="line">                                        }</div>
<div class="line">                                        </div>
<div class="line">                                        <span class="comment">//Set state and sum value and starting state</span></div>
<div class="line">                                        current_state = (*state_val)[j].state_id;</div>
<div class="line">                                        sum = (*state_val)[j].prob;</div>
<div class="line">                                        state_start = j;</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">else</span>{</div>
<div class="line">                                        sum = <a class="code" href="namespace_stoch_h_m_m.html#a067454235ed85f89e1c09dc1f26c71e6">addLog</a>(sum,(<span class="keywordtype">double</span>) (*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[j].prob);</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Normalize the last states seen (b/c) we&#39;ll exit out of for loop before</span></div>
<div class="line">                        <span class="comment">//we have done these</span></div>
<div class="line">                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> k = state_start; k &lt;= (*position)[i]; ++k){</div>
<div class="line">                                (*state_val)[k].prob = exp((*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[k].prob - sum);</div>
<div class="line">                        }</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">//Set values for next loop</span></div>
<div class="line">                        state_start = (*position)[i] + 1;</div>
<div class="line">                        current_state = <a class="code" href="bitwise__ops_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Process and normalize the ending cell</span></div>
<div class="line">                <span class="comment">//Calculate ending state sum</span></div>
<div class="line">                sum = -INFINITY;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=state_start; j &lt; <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;size();j++){</div>
<div class="line">                        sum=<a class="code" href="namespace_stoch_h_m_m.html#a067454235ed85f89e1c09dc1f26c71e6">addLog</a>(sum,(<span class="keywordtype">double</span>)(*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[j].prob);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Normalize the ending cell probability</span></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=state_start; j &lt; <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;size();j++){</div>
<div class="line">                        (*state_val)[j].prob = exp((*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[j].prob - sum);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Assign previous cell relative to (position) value.  Used when traceback</span></div>
<div class="line">                <span class="comment">//That way function won&#39;t have to search for correct value;</span></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i =1; i &lt; <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;size(); ++i){</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = (*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>)[i-1]+1; j &lt;= (*position)[i] ; ++j){</div>
<div class="line">                                (*state_val)[j].prev_cell = <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#acb25865587205a78cff5791c14d461eb">get_state_position</a>(i-1, (*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[j].state_prev);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb25865587205a78cff5791c14d461eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t StochHMM::stochTable::get_state_position </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the states iterator position within the array </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>Position within the sequence </td></tr>
    <tr><td class="paramname">state</td><td>Iterator of state that you want </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Position within the table where state can be found </dd></dl>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00141">141</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00065">position</a>, <a class="el" href="stoch_table_8h_source.html#l00064">state_val</a>, and <a class="el" href="stoch_math_8h_source.html#l00043">UINT16_MAX</a>.</p>

<p>Referenced by <a class="el" href="stoch_table_8cpp_source.html#l00059">finalize()</a>.</p>
<div class="fragment"><div class="line">                                                                       {</div>
<div class="line">                <span class="keywordtype">size_t</span> start_val = (pos == 0) ? 0 : (*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>)[pos-1]+1;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = start_val ; i &lt;= (*position)[pos] ;  ++i){</div>
<div class="line">                        <span class="keywordflow">if</span> ((*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>)[i].state_id == state){</div>
<div class="line">                                <span class="keywordflow">return</span> i-start_val;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="stoch_math_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe93c3bc97d4bc96256d0905c73d16ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochHMM::stochTable::print </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the <a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a> to stdout. </p>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00153">153</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8cpp_source.html#l00159">stringify()</a>.</p>
<div class="fragment"><div class="line">                              {</div>
<div class="line">                std::cout &lt;&lt; <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#ada9bfba8e6f8364190c35bcaa1b0e020" title="Stringify the stochTable.">stringify</a>();</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00d3a5df377d0b618d2e9d705eeaa3ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochHMM::stochTable::push </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>st_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pushes the information for traceback pointer onto the table </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>Position of current traceback pointer in sequence </td></tr>
    <tr><td class="paramname">st</td><td>Current State </td></tr>
    <tr><td class="paramname">st_to</td><td>Previous State </td></tr>
    <tr><td class="paramname">value</td><td>Unnormalized value of traceback pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="class_stoch_h_m_m_1_1stoch_table.html#acda57c084c4fd7fe15b498ab8eb516ce">stochTable::finalize</a> </dd></dl>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00046">46</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00063">last_position</a>, and <a class="el" href="stoch_table_8h_source.html#l00064">state_val</a>.</p>

<p>Referenced by <a class="el" href="stoch__forward_8cpp_source.html#l00174">StochHMM::trellis::naive_stochastic_forward()</a>, <a class="el" href="stoch__viterbi_8cpp_source.html#l00181">StochHMM::trellis::naive_stochastic_viterbi()</a>, <a class="el" href="stoch__forward_8cpp_source.html#l00030">StochHMM::trellis::simple_stochastic_forward()</a>, and <a class="el" href="stoch__viterbi_8cpp_source.html#l00042">StochHMM::trellis::simple_stochastic_viterbi()</a>.</p>
<div class="fragment"><div class="line">                                                                             {</div>
<div class="line">                <span class="keywordflow">if</span> (pos != <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a>){</div>
<div class="line">                        (*position)[<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a>] = <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;size()-1;</div>
<div class="line">                        <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a> = pos;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a91107816897541272e01c391af18496b">state_val</a>-&gt;push_back( stoch_value(st,st_to,value));</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada9bfba8e6f8364190c35bcaa1b0e020"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string StochHMM::stochTable::stringify </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stringify the <a class="el" href="class_stoch_h_m_m_1_1stoch_table.html">stochTable</a>. </p>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00159">159</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00063">last_position</a>, and <a class="el" href="stoch_table_8h_source.html#l00065">position</a>.</p>

<p>Referenced by <a class="el" href="stoch_table_8cpp_source.html#l00153">print()</a>.</p>
<div class="fragment"><div class="line">                                       {</div>
<div class="line">                std::stringstream str;</div>
<div class="line">                </div>
<div class="line">                <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#abd42b5a72712ab79211fe13f2c6450b0">last_position</a> = 0;</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;size();++i){</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = (i==0) ? 0 : (*position)[i-1]+1 ; j &lt;= (*position)[i] ; ++j ){</div>
<div class="line">                                str &lt;&lt; (*state_val)[j].state_id &lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt; (*state_val)[j].state_prev &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; (*state_val)[j].prob &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                        str &lt;&lt; std::endl;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> str.str();</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a54b03475f783c305b38b8edbc11069e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochHMM::stochTable::traceback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_stoch_h_m_m_1_1traceback__path.html">traceback_path</a> &amp;&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Traceback through the table using the traceback probabilities </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">path</td><td>Reference to <a class="el" href="class_stoch_h_m_m_1_1traceback__path.html">traceback_path</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stoch_table_8cpp_source.html#l00177">177</a> of file <a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a>.</p>

<p>References <a class="el" href="stoch_table_8h_source.html#l00065">position</a>, <a class="el" href="traceback__path_8cpp_source.html#l00041">StochHMM::traceback_path::push_back()</a>, <a class="el" href="bitwise__ops_8h_source.html#l00024">SIZE_MAX</a>, and <a class="el" href="stoch_math_8h_source.html#l00043">UINT16_MAX</a>.</p>

<p>Referenced by <a class="el" href="trellis_8cpp_source.html#l00470">StochHMM::trellis::stochastic_traceback()</a>.</p>
<div class="fragment"><div class="line">                                                      {</div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">double</span> random((<span class="keywordtype">double</span>)rand()/((<span class="keywordtype">double</span>)(RAND_MAX)+(<span class="keywordtype">double</span>)(1)));</div>
<div class="line">                <span class="keywordtype">double</span> cumulative_prob(0.0);</div>
<div class="line">                <span class="comment">//std::cout &lt;&lt; random &lt;&lt; std::endl;</span></div>
<div class="line">                </div>
<div class="line">                <span class="keywordtype">size_t</span> offset(0);</div>
<div class="line">                uint16_t state_prev(<a class="code" href="stoch_math_8h.html#a3ea490c9b3617d4479bd80ef93cd5602">UINT16_MAX</a>);</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//Get traceback from END state</span></div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = (*<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>)[<a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;size()-2]+1 ; i &lt;= <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;back() ; ++i){</div>
<div class="line">                        cumulative_prob += (*state_val)[i].prob;</div>
<div class="line">                        <span class="keywordflow">if</span> (random &lt;= cumulative_prob){</div>
<div class="line">                                state_prev = (*state_val)[i].state_prev;</div>
<div class="line">                                path.push_back(state_prev);</div>
<div class="line">                                offset = (*state_val)[i].prev_cell;</div>
<div class="line">                                <span class="comment">//std::cout &lt;&lt; &quot;Chose:\t&quot; &lt;&lt; state_prev &lt;&lt; std::endl;</span></div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="comment">//For the rest of the table traceback to the beginning of the sequence</span></div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = <a class="code" href="class_stoch_h_m_m_1_1stoch_table.html#a833bb508d1aebe85e1b73fc68699bb90">position</a>-&gt;size()-2; i != <a class="code" href="bitwise__ops_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a> ; --i){</div>
<div class="line">                        random = (double)rand()/((double)(RAND_MAX)+(double)(1));</div>
<div class="line">                        <span class="comment">//std::cout &lt;&lt; random &lt;&lt; std::endl;</span></div>
<div class="line">                        cumulative_prob = 0;</div>
<div class="line">                        </div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> cells = (i == 0) ? 0 + offset : (*position)[i-1]+offset+1; cells &lt;= (*position)[i] ; ++cells){</div>
<div class="line"><span class="comment">//                              if ((*state_val)[cells].state_id != state_prev ){</span></div>
<div class="line"><span class="comment">//                                      std::cout &lt;&lt; &quot;Houston, We have an error!&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="comment">//                              }</span></div>
<div class="line">                </div>
<div class="line">                                cumulative_prob+=(*state_val)[cells].prob;</div>
<div class="line">                                </div>
<div class="line">                <span class="keywordflow">if</span> (random &lt;= cumulative_prob){</div>
<div class="line">                    state_prev = (*state_val)[cells].state_prev;</div>
<div class="line">                                        path.push_back(state_prev);</div>
<div class="line">                                        offset = (*state_val)[cells].prev_cell;</div>
<div class="line">                                        <span class="comment">//std::cout &lt;&lt; &quot;Chose:\t&quot; &lt;&lt; state_prev &lt;&lt; std::endl;</span></div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
</div><!-- fragment -->
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="abd42b5a72712ab79211fe13f2c6450b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t StochHMM::stochTable::last_position</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stoch_table_8h_source.html#l00063">63</a> of file <a class="el" href="stoch_table_8h_source.html">stochTable.h</a>.</p>

<p>Referenced by <a class="el" href="stoch_table_8cpp_source.html#l00059">finalize()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00046">push()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00015">stochTable()</a>, and <a class="el" href="stoch_table_8cpp_source.html#l00159">stringify()</a>.</p>

</div>
</div>
<a class="anchor" id="a833bb508d1aebe85e1b73fc68699bb90"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;size_t&gt;* StochHMM::stochTable::position</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stoch_table_8h_source.html#l00065">65</a> of file <a class="el" href="stoch_table_8h_source.html">stochTable.h</a>.</p>

<p>Referenced by <a class="el" href="stoch_table_8cpp_source.html#l00059">finalize()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00141">get_state_position()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00015">stochTable()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00159">stringify()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00177">traceback()</a>, and <a class="el" href="stoch_table_8cpp_source.html#l00033">~stochTable()</a>.</p>

</div>
</div>
<a class="anchor" id="a91107816897541272e01c391af18496b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="struct_stoch_h_m_m_1_1stoch_table_1_1stoch__value.html">stoch_value</a>&gt;* StochHMM::stochTable::state_val</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stoch_table_8h_source.html#l00064">64</a> of file <a class="el" href="stoch_table_8h_source.html">stochTable.h</a>.</p>

<p>Referenced by <a class="el" href="stoch_table_8cpp_source.html#l00059">finalize()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00141">get_state_position()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00046">push()</a>, <a class="el" href="stoch_table_8cpp_source.html#l00015">stochTable()</a>, and <a class="el" href="stoch_table_8cpp_source.html#l00033">~stochTable()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="stoch_table_8h_source.html">stochTable.h</a></li>
<li><a class="el" href="stoch_table_8cpp_source.html">stochTable.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 30 2013 13:23:13 for StochHMM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
